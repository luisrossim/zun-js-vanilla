import"./style-ivoRtsJC.js";import{e as s}from"./toast-DMtRu0CZ.js";function v(e){if(e=e.replace(/\D/g,""),e.length!==11||/^(\d)\1{10}$/.test(e))return!1;let t=0;for(let o=0;o<9;o++)t+=parseInt(e[o])*(10-o);let r=t%11,n=r<2?0:11-r;t=0;for(let o=0;o<10;o++)t+=parseInt(e[o])*(11-o);r=t%11;let a=r<2?0:11-r;return e[9]==n&&e[10]==a}function g(){const e=Array.from({length:9},()=>Math.floor(Math.random()*10)),t=u(e,10),r=u([...e,t],11);return[...e,t,r].join("")}function u(e,t){const n=e.reduce((a,o,p)=>a+o*(t-p),0)%11;return n<2?0:11-n}async function E(e){try{const t=await fetch(`https://viacep.com.br/ws/${e}/json/`);if(!t.ok)throw new Error("Erro ao consultar o CEP!");const r=await t.json();if(r.erro)throw new Error("CEP não encontrado!");return{success:!0,data:r}}catch(t){return{success:!1,message:t.message}}}async function h(e){let t=[];const r=y(e.nome);r.valid||t.push({input:"nome",errorMessage:r.error});const n=C(e.cpf);n.valid||t.push({input:"cpf",errorMessage:n.error});const a=await d(e.cep);return a.valid||t.push({input:"cep",errorMessage:a.error}),console.log(t),t}function y(e){const t=/^[a-zA-Zá-úÁ-Úçãõáàâêîôù\s]*$/;return e===""?{valid:!1,error:"Nome é obrigatório!"}:t.test(e)?e.trim()===""?{valid:!1,error:"Nome inválido!"}:e.trim().length<3?{valid:!1,error:"Nome é muito curto!"}:e.trim().length>20?{valid:!1,error:"Nome é muito longo!"}:{valid:!0}:{valid:!1,error:"Nome inválido! Somente letras e espaços são permitidos."}}function C(e){return v(e)?{valid:!0}:{valid:!1,error:"CPF inválido!"}}async function d(e){if(e==="")return{valid:!1,error:"CEP é obrigatório!"};if(e.length!==9)return{valid:!1,error:"CEP inválido!"};const t=await E(e);return t.success?{valid:!0,consulta:t.data}:{valid:!1,error:t.message}}function S(e){let t=new Date(e);const r=String(t.getDate()+1).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return`${r}/${n}/${a}`}function P(e){return e.trim().replace(/\s+/g," ")}const $=document.querySelector("form"),b=document.querySelectorAll("input, select"),q=document.querySelector("#cpf"),w=document.querySelector("#cep"),F=document.querySelector("#estado"),M=document.querySelector("#cidade"),L=document.querySelector("#bairro"),x=document.querySelector("#gerarCPF"),i=document.querySelector("#consultarCEP");$.addEventListener("submit",e=>{V(e)});x.addEventListener("click",()=>{k()});i.addEventListener("click",()=>{const e=document.createElement("span");e.classList.add("loading-icon"),i.insertAdjacentElement("afterbegin",e),i.disabled=!0,D().finally(()=>{setTimeout(()=>{e.remove(),i.disabled=!1},200)})});b.forEach(e=>{e.addEventListener("input",()=>{const t=e.id;l(t)})});function c(e,t){e.addEventListener("input",r=>{let n=r.target.value.replace(/\D/g,"");n&&(n=t(n)),r.target.value=n})}c(document.querySelector("#cpf"),f);c(document.querySelector("#telefone"),A);c(document.querySelector("#cep"),j);async function V(e){e.preventDefault();const t=new FormData(e.target),r=Object.fromEntries(t.entries());r.nascimento=S(r.nascimento),r.nome=P(r.nome);let n=await h(r);if(n.length>0){let a=[];n.forEach(o=>{a.push(o.input),m(o.input,o.errorMessage)}),s("error",`O(s) campo(s) (${a.join(", ")}) estão inválidos!`);return}l("cep"),s("success","Formulário enviado com sucesso!")}function k(){const e=g(),t=f(e);q.value=t,l("cpf"),s("success","CPF gerado com sucesso!")}async function D(){const e=w.value,t=await d(e);if(!t.valid){m("cep",t.error);return}F.value=t.consulta.estado,M.value=t.consulta.localidade,L.value=t.consulta.bairro,s("success","CEP validado com sucesso!")}function m(e,t){const r=document.querySelector(`#${e}`);let n=r.nextElementSibling;n&&n.classList.contains("helper-text")?n.textContent=t:(n=document.createElement("span"),n.classList.add("helper-text"),n.textContent=t,r.insertAdjacentElement("afterend",n)),r.classList.add("invalid")}function l(e){const t=document.querySelector(`#${e}`),r=t.nextElementSibling;r&&r.classList.contains("helper-text")&&r.remove(),t.classList.remove("invalid")}function f(e){return e.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4")}function A(e){return e.replace(/^(\d{2})(\d{5})(\d{4})$/,"($1) $2-$3")}function j(e){return e.replace(/^(\d{5})(\d{3})$/,"$1-$2")}document.querySelectorAll(".tooltip-container").forEach(e=>{const t=e.getAttribute("data-tooltip"),r=document.createElement("div");r.className="tooltip",r.textContent=t,e.appendChild(r),e.addEventListener("mouseenter",()=>{r.style.display="block"}),e.addEventListener("mouseleave",()=>{r.style.display="none"})});
